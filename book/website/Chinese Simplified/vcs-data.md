(rr-vcs-data)=
# 数据版本控制

我们讨论了控制不断发展的项目组成部分的这一版本，可有助于使工作更有条理、更有效率、更协作和更可复制。 然而，许多科学项目不仅包括代码、手稿或其他小型文件。 许多项目包含较大的文件，例如(投入)数据或分析结果。 可以在项目中更改或被更新，就像代码和手稿等其他组件一样。 如果我们能够根据某种分析或结果追踪数据的颠覆集或版本，科学项目的可再生性方面可以大有改进。

(rr-vcs-data importance)=
## 版本控制数据的重要性

我们不应认为用于分析的数据是静态的。 一旦获得，它就不会改变，也不会成为对某项分析的投入和我们科学成果的基础。 实际情况是，数据很少没有改变。 例如，在整个科学项目中，数据集可以用新的数据加以扩充，适应新的命名办法。 重组为不同的文件分级，使用新的数据点更新或修改以修复任何错误。

Such dynamic processes are excellent and beneficial for science as they ensure that data is usable and up-to-date, but they can be confusing if they are not adequately documented. 如果作为计算科学结果基础的数据集在没有版本控制的情况下发生了变化， 可重复性可能受到威胁：结果可能无效，或者基于不同版本之间更改的文件名的脚本可能会中断。 特别是如果原始数据被没有版本控制的新数据所取代，则分析的原始结果可能无法转载。 因此， 版本控制数据和其他大型文件，与版本控制代码或手稿的方式类似，有助于确保项目的可重复性，并捕获结果的出处； hat 是“精确的子集和数据版本，一组结果来自”。 与一个研究项目的所有其他组成部分一道，准确版本中确定的数据是研究成果的一部分。

```{figure} ../../figures/provenance.jpg
---
高度：500px
name: 出处
alt: 来源于哪个版本的数据是基于哪个版本的计算对于可再生性至关重要。
---
是哪个版本的基础数据的原生数据，哪个版本的计算对于复活性至关重要。
Stereteria的绘画线路项目示例。 在 CC-BY 4.0 许可下使用。 DOI：[10.5281/zenodo.3332807](https://doi.org/10.5281/zenodo.3332807)。
```

(rr-vcs-data challenges)=
## 版本控制数据中的挑战

视数据的大小和所做的修改而定，Git等版本控制工具可能不适合数据。 只要到版本控制的文件大小较小，可以存储在少数 `csv` 或字符分隔的文件中， 工具如 [Git](https://git-scm.com/) 是合适的。

当您在大型上工作、分享和合作时，可能是 [二进制](https://en.wikipedia.org/wiki/Binary_file) 文件(例如许多科学数据格式)， 您需要想想用专门工具来版本控制此数据的方法。 这是因为大多数版本控制工具，如Git，都不适合处理大型二进制数据。 作为Git仓库储存每个添加到它的文件的版本。 定期修改的大型文件可能会大大扩展a····························································································································································································· 如果其他人试图克隆您的资源库或获取/拉取以在本地更新它， 如果它包含了已经被版本和修改的更大的文件，这将需要更长时间。

尤其不方便的是，诸如GitHub 之类的存储库托管服务对用户规定了最大文件大小(至少在其免费版本中)。 例如，如果存储库中的单个文件超过 100MB，您将无法将此文件推送到 GitHub 存储库。 此外，如果一个大文件意外添加到仓库， 从资源库中删除该文件可能是分割的，因为这个文件需要 [清除](https://help.github.com/en/github/authenticating-to-github/removing-sensitive-data-from-a-repository)。 这些缺陷会使控制文件的版本变得变得很烦琐和缓慢，妨碍在拥有大量数据的存储库上的合作。 并防止数据或项目在GitHub 等平台上共享。

(rr-vcs-data tools)=
## 版本控制数据工具

有几个工具可用来处理版本控制和共享大型的 文件。 其中大多数都很好地与Git集成，并将仓库的能力扩展到版本控制大型文件。 通过这些工具，可以将大量数据添加到仓库，版本被控制并还原到以前的状态。 或者以协作方式更新和修改，甚至通过GitHub 作为小型文件共享。 其中一些工具包括：

(rr-vcs-data--tools-lfs)=
### Git LFS

[Git LFS](https://git-lfs.github.com/) 带有命令行扩展到 Git 并允许您使用标准的 Git 命令处理任何大小的文件。 然而，一个主要缺陷是Git LFS 是 _集中的_ 解决方案。 大型文件不会分发，而是存储在远程服务器上。 这通常需要设置您的服务器或支付服务的费用 - 这可能使它非常无法访问。

(rr-vcs-data-tools-gitannex)=
### `git-annex`

[`git-annex`](https://git-annex.branchable.com/) 工具是一个分布式系统，可以管理和共享独立于中央服务或服务器的大型文件。 `git-annex` 管理资源库中单独目录中的所有文件 _内容_ (`)。 it/annex/objects`, 所谓的 _附件_仅放置文件 _name_ 含有一些元数据的 Git 版本控制。 当一个配有附件的Git仓库被推送到诸如GitHub 之类的网络托管服务时，不会上传附件中储存的内容。 相反，它们可以被推到一个存储系统（例如网页服务器）， 但也包括第三方服务，如Dropbox、Google Drive、Amazon S3。box。 om, 和 [更多](https://git-annex.branchable.com/special_remotes/)。 如果一个附有附件的仓库被克隆， 默认情况下，克隆不会包含所有附件文件的 _内容_ ，但只显示文件名。 这使储存库变小，即使它跟踪了数百千兆字节的数据和快速克隆。 当文件内容存储在一个或多个免费或商业的外部存储解决方案中。 当需要时，任何文件内容都可以通过 `git-annex获取` 命令从外部文件存储。

(rr-vcs-data tools-datalad)=
### DataLad

[DataLad](https://www.datalad.org/), 基于 Git 和 git-annex。 像 `git-annex`, 它允许您版本控制数据并通过第三方提供商共享，但是它简化并扩展了这个功能。 除了共享和控制大型文件的版本； 它允许记录、分享和使用软件环境，记录和重新执行命令或数据分析，并无缝地跨越仓库层级运行。
