(rr-vcs-git-merge)=
# Git でブランチをマージする

(rr-vcs-merge-command)=
## `git merge` Command

ブランチの作業が終わったら、メインプロジェクト(または他のブランチ)に統合する準備が整いました。 あなたが作業したブランチをメインブランチや、関心のある他のターゲットブランチに統合できます。 マージを使用して、他の人が自分でやった作業を組み合わせることもできます。

ブランチをマージするには、branch_Aを別のブランチにマージするには、branch_Bをviaに切り替えます:
```
git checkout branch_A
```
それを branch_B にマージする方法:

```
git merge branch_B
```

作業ディレクトリまたはマージ中のファイルによって書き換えられる可能性のあるステージング領域に変更がある場合、マージはできません。 この場合、個々のファイルにマージの競合はありません。 リストされているファイルをコミットまたは隠し、再度試す必要があります。 エラーメッセージは以下の通りです:

```
error: Entry 'your_file_name' not update. 結合できません。 (作業ディレクトリの変更)
```

または

```
error: Entry 'your_file_name' はマージで上書きされます。 結合できません。 (ステージエリアの変更)
```

(rr-vcs-merge-command-practice)=
### 良い練習

まず第一に、あなたの **メインブランチは常に安定している必要があります**. マージ作業のみが終了およびテストされます (異なるブランチなど)。 プロジェクトがコラボレーションしている場合 他の人が自分の仕事に頻繁に加わる変更をマージしたり、自分の変更を共同作業者と共有したりするのは良いアイデアです。 頻繁に行わない場合は、発生する競合(次のセクション)をマージすることは非常に簡単です。

(rr-vcs-merge-conflicts)=
## コンフリクトの結合

異なるブランチで同じファイルに変更が加えられた場合、それらの変更は互換性がない場合があります。 これは最も一般的に共同プロジェクトで行われますが、ソロプロジェクトでも行われます。 例えば、このコード行のファイルが含まれるプロジェクトがあるとします。

```
print('hello world')
```

ある人が枝にあるとします。少し「上に上に上げて」行を変更したとします。

```
print('hello world!!!')
```

他の誰かが別の枝にそれを変更することにしました:

```
print('Hello World')
```

彼らはそれぞれの枝で作業を続け、最終的にマージすることにしました。 バージョン管理ソフトウェアは、その後、ファイルの単一のバージョンに変更を組み合わせます。 *ですが、*は `hello world` ステートメントに到達すると、どのバージョンを使うか分かりません。 これはマージ競合です: 互換性のない変更が同じファイルに行われています。

マージの競合が発生すると、マージ処理中にフラグが立てられます。 競合するファイル内では、互換性のない変更がマークされるため、以下のように修正できます。

```
<<<<<<< HEAD
print('hello world!!!')
=======
print('Hello World')
>>>>>>> main
```
`<<<<<<<`: マージ競合があった行の開始を示します。 行の最初のセットは、変更をマージしようとしていたファイルからの行です。

`=======`: 比較に使用されるブレークポイントを示します。 ユーザーがコミットした変更(上記)と、マージ(下記)から得られる変更(視覚的な比較)を区別します。

`>>>>>>>`: マージ競合があった行の末尾を示します。

Gitがマージできなかったファイルの一部を手動でマージするようにファイルを編集して競合を解決します。 これは、あなたの変更または他の誰かが両方を混在させることを意味するかもしれません。 You will also need to delete the `<<<<<<<`, `=======`, and `>>>>>>>` in the file. このプロジェクトでは、ユーザーは `hello world` を別のものに賛成することができます。 紛争に取って代わることもあります

```
print('Hello World!!!')
```

競合を修正したら、新しいバージョンをコミットします。 競合を解決しました。 処理中に競合ファイルがどのファイルにあるかを確認する必要がある場合は、 `git status` を使用して調べることができます。

特に厄介な競合があり、あなたが使用できるマージを中止したい場合:
```
git merge --abort
```

(rr-vcs-merge-conflicts-practice)=
### 良い練習

競合を解決しようとする前に 変化を十分に理解してくださいそしてそれらが両立しないように 事態をより絡ませるリスクを回避するために Merge の競合は、特に多くのコミットを分岐し、多数の非互換性があるブランチをマージしている場合は、解決することができます。 ただし、以前のバージョンは安全であり、過去のバージョンに影響を与えずにこの問題を修正することができます。 これが、 **相手の変更を頻繁にあなたの仕事にマージする**ことをお勧めする理由です。

マージ競合の解決に役立つツールがあります。無料ツールもあります。そうでないツールもあります。 あなたのために働くものを見つけ、あなた自身をよく理解しなさい。 一般的に使用されるマージツールには、 [KDiff3](http://kdiff3.sourceforge.net/)、 [比較](https://www.scootersoftware.com/)、 [加工](http://meldmerge.org/)、および [P4Merge](https://www.perforce.com/products/helix-core-apps/merge-diff-tool-p4merge) が含まれます。 ツールをデフォルトとして設定するには:

```
git config --global merge.tool name_of_the_tool
```

次の場所で起動します:

```
git mergetool
```

基本的にはマージ競合に対処する最善の方法は、最初の場所でそれらを避けることを試みることです。 ブランチをきれいに保ち、1つの問題に焦点を当て、可能な限り少ないファイルを含めることで、これに対する確率を向上させることができます。 マージする前に、両方のブランチに何があるかを確認してください。 枝に取り組んでいるのはあなただけではない場合 だったらコミュニケーションの線を開けたままにしておきなさい。
