(rr-renv-package)=
# نظم إدارة الحزم

يقوم مديرو الحزمة بتثبيت وتعقب مختلف مجموعات البرمجيات (وإصدارها) التي تستخدمها في بيئة ما. هناك عدد لا بأس به من الخيارات على سبيل المثال Yum، Zypper، dpkg، ونيكس (والذي سيتم ذكره في قسم {ref}`rr-renv-binder`). سوف نركز على [كوندا](https://conda.io/en/latest/)، الذي لديه عدة وظائف مفيدة.

(rr-renv-package-conda)=
## ماذا يفعل كوندا؟

"كوندا" يسمح للمستخدمين بإنشاء أي عدد من البيئات المنفصلة تماماً، والسرعة والتبديل بينهم. على سبيل المثال، قل أن الباحث لديه مشروع، _المشروع الأول_، والذي له بيئته الخاصة التي يحددها كوندا، والتي تتكون من المجموعة التالية من الطرود:

| **اسم الحزمة** | **الإصدار** |
| -------------- | ----------- |
| `الحزمة A`     | `1.5.2`     |
| `الحزمة B`     | `2.1.10`    |
| `الحزمة C`     | `0.7.9`     |

في وقت لاحق، يبدأ الباحث _المشروع الثاني_ في بيئته الخاصة، بالحزم التالية:

| _اسم الحزمة_ | _الإصدار_ |
| ------------ | --------- |
| `الحزمة B`   | `2.1.10`  |
| `الحزمة C`   | `1.2.4`   |
| `الحزمة D`   | `1.5.2`   |
| `الحزمة E`   | `3.7.1`   |

لاحظ هنا أن نسخة `الحزمة C` المستخدمة في _المشروع الثاني_ تم تحديثها من الإصدار المستخدم في _المشروع الأول_. وإذا لم تكن بيئات المشاريع هذه منفصلة، فإن للباحث عندئذ أن يختار ما يلي:

- A استخدام الإصدار القديم من `الحزمة C` إلى الأبد وعدم الاستفادة من التحديثات و الأخطاء في الإصدارات اللاحقة.
- باء - تثبيت النسخة المستكملة من الحزمة وآمل ألا تؤثر على _المشروع الأول_.
- جيم - تثبيت النسخة المحدثة من الحزمة لاستخدامها في _المشروع الثاني_، ثم قم بإلغاء تثبيته وإعادة تثبيت القديم كلما احتاجوا إلى العمل على _مشروع واحد_. ومن شأن ذلك أن يكون مزعجا للغاية وأن يكون خطوة في خطر النسيان.

وجميع هذه الخيارات ضعيفة للغاية، ومن ثم فإن فائدة كوندا في تهيئة بيئات متميزة يسهل تبادلها فيما بينها.

ويمكن أيضا استخدام كوندا في الاستيلاء على البيئات الحسابية وتصديرها بسهولة. يمكن أن يذهب في الاتجاه الآخر أيضا؛ يمكنه إنشاء بيئات حسابية من ملفات التكوين التي يمكن استخدامها لإعادة إنشاء بيئة شخص آخر.

ومن المزايا الأخرى لكوندا أنها توفر مرونة أكبر بكثير للمستعملين الذين لا يتمتعون بامتيازات المشرف على الآلات التي يعملون عليها (كما هو شائع جدا عند العمل مع مرافق الحوسبة ذات الأداء العالي). وبدون كوندا، من الصعب عادة تركيب البرمجيات المطلوبة على هذه الآلات. لكن، لأن كوندا ينشئ ويغير _البيئات الجديدة_ بدلاً من إجراء تغييرات على بيئة النظام العامة للآلة، فإن امتيازات المشرف ليست مطلوبة.

وأخيرا، في حين أن كوندا يتمركز بدرجة ما في البيتون، فإنه أيضا مدمج جيدا لاستخدامه مع اللغات الأخرى. فعلى سبيل المثال، تتضمن النسخة الأساسية من كوندا المكتبة القياسية C++.

(rr-renv-package-installing)=
## تثبيت كوندا

لاحظ أن تعليمات التثبيت هذه موجهة نحو أنظمة لينوكس. يمكن العثور على التعليمات لتثبيت كوندا على أنظمة Windows أو Mac [هنا](https://docs.conda.io/projects/conda/en/latest/user-guide/install/).

انتقل إلى [https://repo.continuum.io/miniconda/](https://repo.continuum.io/miniconda/) وقم بتنزيل أحدث تثبيت Miniconda 3 للنظام الخاص بك (32 بت أو 64 بت). سيكون لها اسم مثل `miniconda_version_number.sh`. تشغيل المثبت بإستخدام:

```
باش Miniconda_version_number.sh
```

يمكنك التحقق من أن كوندا قد تم تثبيته بنجاح عن طريق الكتابة:

```
كوندا - الإصدار
```

الذي يجب أن يخرج رقم الإصدار.

(rr-renv-use package-using)=
## صنع واستخدام البيئات

يقوم كوندا تلقائياً بتثبيت بيئة أساسية مع بعض حزم البرمجيات الشائعة الاستخدام. ومن الممكن العمل في هذه البيئة الأساسية؛ غير أنه من الممارسات الجيدة تهيئة بيئة جديدة لكل مشروع تشرع فيه.

لإنشاء بيئة ، استخدم `conda create --name your_project_env_name` تليها قائمة من الحزم لتضمينها . لتضمين حزم `scipy` و `matplotlib` ، أضفها إلى نهاية الأمر:

```
كوندا ينشئ --اسم مشروع_واحد ماسكتلب
```

يمكنك تحديد إصدارات معينة (أو جميع) الحزم باستخدام `=package_number` بعد الاسم. على سبيل المثال، لتحديد `scipy 1.2-1` في البيئة المذكورة أعلاه:

```
كوندا ينشئ --اسم مشروع_واحد سيبي=1.2.1 matplotlib
```

عند إنشاء البيئات، يمكنك أيضا تحديد إصدارات من اللغات لتثبيتها. على سبيل المثال، لاستخدام `Python 3.7.1` في _مشروع واحد_ البيئة:

```
كوندا ينشئ --اسم مشروع_واحد python=3.7.1 scipy=1.2.1 matplotlib
```

الآن بعد أن تم إنشاء بيئة ، حان الوقت لتفعيل (بدء استخدامها) عن طريق `conda activate environment_name`. في هذا المثال:

```
تفعيل المشروع_الأول
```

لاحظ أنك قد تحتاج إلى استخدام `المصدر` بدلاً من `conda` إذا كنت تستخدم نسخة قديمة من كوندا.

بمجرد تفعيل بيئة ما، يجب أن ترى اسم البيئة قبل كل توجيه في المحطة الطرفية الخاصة بك:

```
(Project_One) $ بايثون --الإصدار
بايثون 3.7.1
```

(rr-renv-deleage-packting)=
## تعطيل وحذف البيئات

يمكنك إلغاء تنشيط (الخروج من) البيئة باستخدام:

```
تعطيل الكوندا
```

وإزالة (حذف) بيئة كما هو مبين هنا:

```
conda env إزالة --اسم مشروع_واحد
```

للتحقق مما إذا كانت بيئة قد تمت إزالتها بنجاح، يمكنك النظر إلى قائمة بجميع بيئات كوندا على النظام باستخدام ما يلي:

```
قائمة conda env
```

ومع ذلك، فإن حذف بيئة قد لا يحذف ملفات الحزمة التي كانت مرتبطة بها. وهذا يمكن أن يؤدي إلى إهدار الكثير من الذاكرة على حزم لم تعد مطلوبة. الحزم التي لم تعد مشار إليها من قبل أي بيئات يمكن حذفها باستخدام:

```
حدائق نظيفة
```

بدلاً من ذلك، يمكنك حذف بيئة (مثل _Project_One_) إلى جانب الحزم المرتبطة بها عن طريق ما يلي:

```
إزالة الكوندا --اسم المشروع_واحد --الكل
```

(r-renv-package-إزالة)=
## تثبيت وإزالة الحزم داخل البيئة

في بيئة ما، يمكنك تثبيت المزيد من الحزم باستخدام:

```
تثبيت conda package_name
```

بالمثل، يمكنك إزالتها عن طريق:

```
إزالة اسم الحزمة_conda
```

هذه هي أفضل طريقة لتثبيت الحزم من داخل كوندا كما أنها ستقوم أيضا بتثبيت نسخة من الحزمة مكيفة حسب احتياجات كوندا. غير أنه من الممكن استخدام أساليب أخرى إذا لم تكن هناك نسخة محددة من الطرد في كوندا. على سبيل المثال، `pip` يستخدم عادة لتثبيت حزم بايثون بايثون. إذاً، أمر مثل:

```
pip install scipy
```

سيتم تثبيت حزمة `scipy` صراحة-طالما تم تثبيت `pip` داخل بيئة كوندا النشطة حاليا. لسوء الحظ، عندما يتم استخدام كوندا و `بيب` معا لإنشاء بيئة ويمكن أن يؤدي إلى حالة يصعب إعادة إنتاجها. وعلى وجه التحديد، فإن تشغيل كوندا بعد `pip` قد يستبدل أو يعطل الحزم المثبتة عبر `pip`. وإحدى الطرق لتجنب ذلك هي تركيب أكبر عدد ممكن من المتطلبات مع كوندا، ثم استخدام الأنابيب. يمكن قراءة معلومات مفصلة على المشاركة، [استخدام الخرسانة في بيئة كوندا](https://www.anaconda.com/using-pip-in-a-conda-environment/).

على الرغم من استخدام حزم بايثون في العديد من الأمثلة المقدمة هنا، فإن حزم كوندا لا يجب أن تكون حزم بايتون. على سبيل المثال، هنا تم تثبيت لغة R الأساسية جنبا إلى جنب مع حزمة R `r-yaml`:

```
كوندا إنشاء --اسم مشروع_قاعدة r-yaml
```

لمشاهدة جميع الحزم المثبتة في البيئة الحالية، استخدم:

```
قائمة كوندا
```

للتحقق مما إذا تم تثبيت حزمة معينة، على سبيل المثال، `scipy` في هذه الحالة:

```
conda list scipy
```

قناة كوندا هي المكان الذي قامت بتنزيل حزمة منه. تشمل القنوات الشائعة `أناكوندا` (شركة توفر قناة الحزمة الافتراضية) و `كوندا - فورج` (مسعى التعبئة الذي يقوده المجتمع). يمكنك تثبيت حزمة بشكل صريح من قناة معينة عن طريق تحديدها كما يلي:

```
تثبيت conda -c channel_name package_name
```

(rr-renv-package-exporting)=
## البيئة الحسابية للتصدير والاستنساخ

يمكن تصدير بيئات كوندا بسهولة إلى ملفات قابلة للقراءة البشرية بتنسيق YAML. تتم مناقشة ملفات YAML بمزيد من التفصيل {ref}`لاحقاً <rr-renv-yaml>` في هذا الفصل.

لتصدير بيئة كوندا إلى ملف يسمى `environment.yml`، قم بتفعيل البيئة ثم قم بتشغيل:

```
تصدير conda env > environment.yml
```

وبالمثل، يمكن إنشاء بيئات كوندا من ملفات YAML عن طريق ما يلي:

```
كوندا إنف خلق -f environment.yml
```

وهذا يتيح للباحثين أن يستنسخوا البيئات الحاسوبية للباحثين بسرعة. لاحظ أن قائمة الطرود ليست فقط تلك المثبتة صراحة. ويمكن أن تشمل مجموعات الإعالة الخاصة ببرمجيات المصدر المفتوح بحيث أن ملفات البيئة قد تتطلب بعض التحرير لكي تكون محمولة إلى نظم تشغيل مختلفة.

ويمكن أيضا استنساخ البيئات. وقد يكون ذلك مستصوبا، على سبيل المثال، إذا بدأ أحد الباحثين مشروعا جديدا وأراد تهيئة بيئة جديدة للعمل في هذا المشروع؛ وقد تتطلب بيئة المشروع الجديد (في البداية على الأقل) نفس الطرود التي تحتاج إليها بيئة المشروع السابقة.

على سبيل المثال، لاستنساخ بيئة _Project_One_ وإعطاء هذه البيئة الجديدة اسم _Project_Two_:

```
كوندا ينشئ --اسم مشروع_اثنين --استنساخ مشروع واحد
```
