(rr-vcs-data)=
# データのバージョン管理

我々は,進化するプロジェクトの構成要素を制御するバージョンが,作業をより組織化し,効率的で,コラボレーションし,再現できるようにするのに役立つことについて議論した。 しかし、多くの科学プロジェクトには、コード、原稿、またはその他の小サイズのファイルが含まれているだけではありません。 多くのプロジェクトには、(入力)データや解析結果などのより大きなファイルが含まれています コードや原稿のような他のコンポーネントと同じようにプロジェクトで変更や更新を行うことができます 特定の分析または結果が基づいているデータのサブセットまたはバージョンを追跡できる場合、科学プロジェクトの再現性の側面は大きく改善することができます。

(rr-vcs-data-importance)=
## バージョン管理データの重要性

分析に使用されるデータが静的であるという概念を保持するべきではありません。 一度獲得すれば、それは変化せず、特定の分析と我々の科学的成果のバックボーンへのインプットとなります 現実には、データが不変であることはほとんどありません。 たとえば、科学プロジェクト全体で、データセットを新しいデータで拡張し、新しい命名方式に適応させることができます。 異なるファイル階層に再編成され、新しいデータポイントで更新されたり、エラーを修正するために修正されます。

このような動的プロセスは、データが使用可能で最新のものであることを保証するため、科学にとって優れており、有益です。 しかし、彼らが 適切に文書化されていなければ、彼らは混乱する可能性があります。 科学的な結果を計算するための基礎となるデータセットがバージョン管理なしに変更された場合。 再現性を脅かす可能性があります:結果が無効になったり、バージョン間で変更されるファイル名に基づいたスクリプトが壊れる可能性があります。 特に、バージョン管理が行われていない新しいデータに置き換えられた場合、解析の元の結果は再現できない場合があります。 そのため、 コードや写本を制御するバージョンと同様の方法でデータやその他の大きなファイルを管理するバージョンは、プロジェクトの再現性を確保し、結果の証明をキャプチャするのに役立ちます。 hat は「データの正確なサブセットとバージョンは、結果のセットから生じる」です。 研究プロジェクトの他のすべてのコンポーネントと一緒に、正確なバージョンで特定されたデータは、研究成果の一部です。

```{figure} ../../figures/provenance.jpg
---
height: 500px
name: provenance
alt: 再現性のためにどのような計算が不可欠かったバージョンのデータを基にした証明。
---
再現性のために計算が極めて重要であるバージョンのデータの証明。
_Scriberiaによるチューリング方法_プロジェクトのイラスト。 CC-BY 4.0ライセンスの下で使用される。 DOI: [10.5281/zenodo.3332807](https://doi.org/10.5281/zenodo.3332807)
```

(rr-vcs-data-challenges)=
## バージョン管理の課題

データのサイズや変更に応じて、Git などのバージョン管理ツールがデータに適していない場合があります。 As long as the files to version control are small in size and can be stored in a few `csv` or character separated files, tools such as [Git](https://git-scm.com/) are appropriate.

作業を行ったり、大規模な、潜在的に [バイナリ](https://en.wikipedia.org/wiki/Binary_file) ファイル（多くの科学データフォーマットなど）で共有したり、共同作業を行ったりすることができます。 このデータを特殊なツールでバージョン管理する方法を考える必要があります これは、Git などのほとんどのバージョン管理ツールが、大規模なバイナリデータの処理には適していないためです。 Git リポジトリには、追加されたすべてのファイルのすべてのバージョンが格納されています。 定期的な変更を受ける大きなファイルは、大幅にa·プロジェクトのサイズを膨らませることができます。 リポジトリをローカルで更新するためにリポジトリまたはフェッチ/プルのクローンを試みた場合。 バージョン管理および修正された大きなファイルが含まれている場合、これを行うには時間がかかります。

特に不便なのは、GitHubのようなリポジトリホスティングサービスがユーザに最大のファイルサイズを課していることです(少なくとも無料版では)。 たとえば、リポジトリ内の 1 つのファイルが 100MB を超えると、GitHub リポジトリにこのファイルをプッシュすることはできません。 さらに、大きなファイルがリポジトリに誤って追加された場合。 ファイルをリポジトリから削除するのは、 [パージされた](https://help.github.com/en/github/authenticating-to-github/removing-sensitive-data-from-a-repository)を行う必要があるため、退屈です。 これらの欠点は、ファイルの管理を面倒で遅く、大きなデータを持つリポジトリのコラボレーションを妨げる可能性があります。 データを含むデータやプロジェクトが GitHub などのプラットフォームで共有されることを防ぎます。

(rr-vcs-data-tools)=
## バージョン管理用のツール

大きな ファイルのバージョン管理と共有を処理するためのいくつかのツールがあります。 それらのほとんどはGitと非常によく統合され、リポジトリの機能を拡張して大きなファイルのバージョン管理を行います。 これらのツールを使用すると、大きなデータをリポジトリに追加し、バージョン管理、以前の状態に戻すことができます。 GitHub経由で小容量のファイルとして共有することもできます。 これらのツールのいくつかは以下のとおりです:

(rr-vcs-data--tools-lfs)=
### Git LFS

[Git LFS](https://git-lfs.github.com/) には Git へのコマンドライン拡張機能が付属しており、標準の Git コマンドを使用して、あらゆるサイズのファイルを同じように扱うことができます。 しかし、大きな欠点は、Git LFSが _集中化された_ ソリューションであることです。 大きなファイルは配布されず、リモートサーバに保存されます。 これは通常、サーバーの設定やサービスの支払いを必要とします。これは非常にアクセス不能になります。

(rr-vcs-data-tools-gitannex)=
### `git-annex`

[`git-annex`](https://git-annex.branchable.com/) ツールは、中央サービスまたはサーバーから独立した大容量ファイルを管理し、共有できる分散システムです。 `git-annex` manages all file _content_ in a separate directory in the repository (`.git/annex/objects`, the so-called _annex_) and only places file _names_ with some metadata into version control by Git. Annex を含む Git リポジトリが GitHub などの Web ホスティングサービスにプッシュされると、アネックスに保存されているコンテンツはアップロードされません。 代わりに、ストレージシステム(ウェブサーバーなど)にプッシュすることができます。 Dropbox、Google Drive、Amazon S3、boxなどのサードパーティのサービスもあります。 om, and [more](https://git-annex.branchable.com/special_remotes/)). アネックスを持つリポジトリがクローンされている場合 複製には、デフォルトですべての添付ファイルの _コンテンツ_ が含まれず、ファイル名のみが表示されます。 これにより、リポジトリは数百ギガバイトのデータを追跡し、高速に複製しても小さくなります。 ファイルの内容は1つ以上の無料または商業的な外部ストレージソリューションに保存されています。 オンデマンドで、外部ファイルストレージから `git-annex get` コマンドで任意のファイルコンテンツを取得できます。

(rr-vcs-data-tools-datalad)=
### DataLad

[DataLad](https://www.datalad.org/)はGitとgit-annexを基に構築されている。 `git-annex`と同様に、サードパーティのプロバイダを介してデータをバージョン管理し、共有することができますが、この機能を簡素化して拡張することができます。 大きなファイルの共有とバージョン管理に加えて、 ソフトウェア環境の記録、共有、使用、コマンドやデータ解析の記録と再実行、リポジトリの階層全体でシームレスに動作することができます。
